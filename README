TODO:

* change over to Z sets for indexes 
* change to index rather than 'link'
* add test cases for above
